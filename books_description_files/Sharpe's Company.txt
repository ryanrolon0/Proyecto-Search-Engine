The story begins with the British Army's assault on Ciudad Rodrigo, the northern barrier into Spain. Sharpe and Harper lead an assault on the French, displaying their usual bravery. Unfortunately, during the assault Sharpe's commander and friend Colonel William Lawford is severely wounded when a mine is detonated. He loses an arm and retires from his post as commander of the South Essex regiment. Sharpe is devastated, not only at the loss of a friend, but also by the fact that his captaincy is up for sale, and without Lawford to defend him, he is likely to lose command of his company. Sharpe's situation only gets worse when his old enemy, Sergeant Obadiah Hakeswill, joins the company. Hakeswill hates Sharpe with a vengeance and plans to kill him. Meanwhile, Sharpe's lover Teresa Moreno arrives, informing Sharpe that she has given birth to his daughter Antonia, and that she is living in Badajoz as a citizen. Sharpe promises her that he will protect her when the British army attacks the city. He is also reunited with his former Lieutenant, Robert Knowles, who is now a captain of a fusilier company. Knowles also vows to protect Teresa. Later, Hakeswill encounters Teresa in a stable. He attempts to rape her, but she fights him off, slashing his face and wrist. Sharpe and Harper enter the stable, and Harper brutally beats Hakeswill, throwing him into a puddle of urine. Hakeswill vows revenge on Harper. At this very moment Lawford's replacement, Colonel Windham arrives, as well as Captain Rymer, who has bought command of Sharpe's company. Sharpe is demoted to lieutenant, but Windham attempts to cheer him up by telling him vacancies will soon be available. The army then begins its siege of Badajoz. Sharpe is given command of the regiment's baggage, ordered to guard it while the regiment digs trenches around the city. Sharpe leaves the baggage to visit his company, and when Rymer attempts to talk to him, the French attack. Rymer does nothing, so Sharpe leads his men into battle. The French are unable to fire their muskets due to a heavy rainfall, so Sharpe attacks with his sword, and Harper attacks with a shovel. The French are defeated, but in Sharpe's absence the regiment's baggage is plundered by Hakeswill. Windham is furious with Sharpe for abandoning his post, and is further angered when he discovers that a silver framed portrait of his wife has gone missing. He searches the packs of all the members of the Light Company, and the frame, but not the picture, is found in Harper's bag. Windham has Harper demoted to private and flogged, but is so impressed by Harper's bravery (and ashamed by his own rashness) that he compliments Harper afterwards and gives him money. A few nights later, Windham sends the Light Company on a mission to destroy a section of the French fortifications. He asks Sharpe to serve as his aide. Before the attack, Harper's seven-barrelled gun is taken from him by Hakeswill, as it is a non-regulation weapon. When the Light Company takes longer than expected, Windham sends Sharpe to find out the cause of the delay. Sharpe arrives to see the Light Company doing nothing, due to Rymer's incompetence. Sharpe fires at a French sentry and decides to blow the wall himself. Sharpe's riflemen give him cover fire as he attempts to light the fuse on the powder barrels. The barrels explode, but the wall is too strong to be destroyed. As Sharpe falls back he is shot in the leg by Hakeswill using Harper's seven-barrelled gun. Windham decides to remove Sharpe temporarily to allow Rymer to establish his authority, though he knows Sharpe is a brilliant soldier. He also orders the riflemen to abandon their rifles, which Rymer, at Hakeswill's prompting, blames the mission's failure on, as well as their green jackets. As Hakeswill taunts the disarmed riflemen, Sharpe defends them, humiliating Hakeswill by pretending to shoot him. Hakeswill is more than ever determined to get revenge, and also plans to get to Teresa in Badajoz before Sharpe does. Sharpe is interviewed by the army commander, the Duke of Wellington, a few days later after Sharpe has viewed the city closely. Wellington decides to attack the city that night. Sharpe is ordered to guide the various regiments into their positions. During his job he rejoins his regiment, which has been devastated by the French cannon fire. Windham is bravely trying to lead his men into the breach, and when Sharpe reaches his company, he discovers Rymer has been shot dead. Sharpe once again takes command of his company. Meanwhile, Knowles has managed to reach the top of the French wall and leads his men into the city. While his men kill the French and plunder the homes, Knowles looks for Teresa to protect her. Unknown to him, Hakeswill has also entered the city, armed with his bayonet and a stolen pistol. Knowles reaches Teresa's house, and Teresa lets him in, but Hakeswill climbs to the upstairs room where Antonia is, and as Knowles enters, Hakeswill shoots him. He then threatens to kill the baby unless Teresa has sex with him. Meanwhile, Sharpe has led his men through the French cannon. Not only his company, but the entire regiment follow his lead. Sharpe and Harper fight their way through the French to reach Teresa, and enter the house face to face with Hakeswill. Harper picks up Hakeswill's discarded shako, and finds the picture of Windham's wife inside it, whom Hakeswill believes to be his mother. Harper threatens to destroy the picture unless Hakeswill releases Antonia. Hakeswill releases the baby, and as Harper, Sharpe, and Teresa all attempt to kill him, he escapes by leaping out a window. At the end of the battle, Windham praises Sharpe for his bravery. Sharpe returns his wife's portrait, and Windham apologizes to Harper. Sharpe is once again made a captain, and Harper is once again made a sergeant. The riflemen also have their green jackets and rifles restored to them. Hakeswill deserts from the army, and will return to trouble Sharpe again in "Sharpe's Enemy".