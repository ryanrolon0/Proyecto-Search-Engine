Rebus finds himself with a number of problems on his hands. His wayward brother, Michael, has returned to Edinburgh in need of accommodation - with only the box-room in Rebus's flat available. While out drinking, he meets an old army friend, Deek Torrance, who admits to being involved in shady activities, telling Rebus he can get his hands on 'anything from a shag to a shooter'. Rebus spends so long out with Deek that he misses dinner with his girlfriend, Doctor Patience Aitken. Furious, she locks him out of her flat, forcing him to sleep in his own flat, on the sofa. At work, a new operation ('Moneybags') is started, aimed at putting one of 'Big Ger' Cafferty's money-lenders out of business. However, Rebus (who despises Cafferty) would rather go after the leader himself. Finally, Rebus's colleague Brian Holmes is put into a coma after being attacked from behind in the carpark of his favourite restaurant, the Elvis-themed Heartbreak Cafe. Rebus interviews Eddie Ringan, the Elvis enthusiast who owns the restaurant, and Pat Calder, Eddie's gay (and business) partner, but they prove to be of little help. Brian's girlfriend, Nell Stapleton, tells Rebus that Brian had a 'Black Book', a small notebook in which he kept interesting snippets of information. She suggests that Brian was attacked because of something in it. She also feels guilty, since she had argued with Brian just before he went to the restaurant. When Rebus recovers the book, one entry in particular catches his interest. Five years ago, a mysterious fire burned Edinburgh's seedy Central Hotel down. Although all the staff and customers were accounted for, an unidentified body was found in the remains. The entry in the black book talks about a poker game that took place on the night the fire happened. However, it is written in cryptic shorthand, with obscure nicknames instead of the real names of the poker players. Rebus's first action is to discuss the autopsy of the unidentified body with the pathologist Dr Curt, who still remembers it in grisly detail. The autopsy revealed that the deceased had been shot through the heart, as well as having suffered a broken arm sometime in the past. Meanwhile, Operation 'Moneybags' is set to get into swing, with Rebus supervising one of the surveillance teams. Under his command is Detective Constable Siobhan Clarke, at this time a new recruit to the force. Rebus turns to an old friend of his, Matthew Vanderhyde, an elderly blind man who helped him in Hide and Seek. In the 1950s, Vanderhyde used to go to the Central Hotel for rallies for Sword and Shield, a hardline offshoot of the Scottish National Party. He was there the night it burned down, having a drink with a friend, Aengus Gibson, also known as 'Black Aengus'. Heir to the Gibson brewing business, Aengus was a wild drunk at the time of the fire, but has since reformed. He was not on the list of people who was at the hotel due to his family's influence. The day after a night of arguments with Michael and the students, Rebus discusses Cafferty with Siobhan. Siobhan mentions the 'Bru-head Brothers', Tam and Eck Robertson, a pair of criminals who disappeared at around the same time as the Central fire. Rebus then realises that the one of the names in the Black Book refers to them, and another to Cafferty himself. When Rebus returns home, he receives grim news about his brother, who has just been found hanging by his legs from the Forth Rail Bridge. Michael is in shock and has to be taken to hospital. Fearing for the safety of his brother, Rebus decides that he needs serious protection. Remembering Deek Torrance's words 'anything from a shag to a shooter', Rebus decides to get in touch with his old friend. The following day, while overseeing the dull minutae of the Operation Moneybags surveillance, Rebus and Siobhan hear welcome news - Brian Holmes has recovered consciousness. While he cannot remember anything about his assailant, he does tell Rebus that the final name in the Black Book refers to Eddie Ringan, the chef of the Heartbreak Cafe, who told Brian about the poker game. Rebus returns to the Heartbreak Cafe, and demands to know what happened on the night of the fire. He knows that Eddie was moonlighting at the Central, which is why he never appeared on the list of people who were there. Eddie, an alcoholic, flies into a drunken rage, hurting his assistant Willie in the process. But as Rebus turns to leave, Eddie suggests visiting a pub in Cowdenbeath. Armed with two sketches of the Robertson brothers as they might appear today, Rebus visits several Cowdenbeath pubs, asking customers if they recognise them. He has little luck, although a drunk old gambler claims he recognises one of the pictures, causing Rebus to suspect that one of the brothers may be working as a bookmaker. The next day, Rebus learns that Eddie has disappeared after a night out. Pat Calder insists to Rebus that Eddie always returns home safely, despite his alcohol problem. Willie, the assistant chef, is of little help. Rebus suspects that Eddie may have been warned off, or worse. Meanwhile, Rebus's superiors are annoyed at the effort he is putting into the Central Hotel case. Undaunted, Rebus approaches Aengus Gibson, who admits being at the hotel on the night of the fire with Vanderhyde, but insists that he left hours before the fire actually began. Rebus, however, is suspicious. Later that night, Rebus meets up with Deek Torrance, and arranges to buy a handgun from him. Chief Superintendent 'Farmer' Watson demands an explanation for Rebus's continued interest in the Central Fire, giving him twenty-four hours to come up with something concrete. Later that day, Rebus goes to Pat Calder and Eddie's flat to fill out an official missing person report. Calder reveals that Willie had cracked up trying to cope without Eddie, making a scene before leaving the restaurant. With few options left open to him, Rebus decides to talk to Morris Gerald Cafferty at his upmarket home in Duddingston. The two men's mutual loathing results in a tense confrontation. While Cafferty reveals relatively little, he does admit that the Robertson Brothers used to work for him as 'general employees', but left his service years ago. As Rebus leaves, he is certain that Cafferty was behind the attack on Michael. Meanwhile, Siobhan is out getting extra camera film for the Operation Moneybags surveillance, and walks past the Heartbreak Cafe. Smelling gas, she enters and discovers Eddie Ringan's body with the head inside the oven, an apparent suicide. Dr Curt's examination of Eddie's badly burned body turns up some suspicious findings. The deceased's liver was in good condition, even though Eddie was a persistent heavy drinker. There are also strange injuries inside the mouth. That night, Rebus meets with Deek Torrance in North Queensferry to buy the handgun, a Colt 45, which he hides in his car. Mulling over the cases, Rebus visits a Catholic church and confesses to the priest that he has bought a gun. The priest advises him to throw it into the sea. Rebus decides to do just that. Returning to St Leonards, Rebus is confronted by his immediate superior, Chief Inspector Lauderdale, who demands Rebus surrender his car keys. Rebus realises that his colleagues have been tipped off about the gun. But worse is to come, as the gun turns out to be the same one used in the Central Hotel shooting five years ago. Rebus is suspended from duty. After attending Eddie Ringan's funeral, Rebus has a suspicion of what happened. After checking the reservations book for the Heartbreak Cafe, he finds out that none of the customers remember Willie making a scene and storming out. His suspicions confirmed, Rebus goes to Eddie and Pat's flat, and finds the still living Eddie Ringan hiding there. He and Pat had rendered Willie unconscious by forcing alcohol down his throat, and used his body to stage a suicide attempt. Rebus arrests Eddie, but while taking him back to the station, stops in front of Cafferty's mansion. Eddie is clearly terrified of Cafferty, and admits that he helped burn down the Central Hotel, after a blood-splattered Aengus Gibson ran into the hotel kitchens. Siobhan, having checked the medical records of a Dundee hospital, reveals that Tam Robertson had broken an arm twelve years ago. The corpse found in the remains of the Central belonged to him. Rebus confronts Aengus Gibson, demanding to know what happened at the night of the fire, but is forced to leave by Aengus's father. Returning to Fife, Rebus visits a bookmaker owned by Eck Robertson, living under a false name. Eck says that Aengus shot Tam for cheating during the poker game. Back in Edinburgh, Aengus Gibson has committed suicide. When Rebus reads Aengus's journal, it becomes clear that he thought that he was about to be arrested for the murder of Tam Robertson. The journal also reveals that it was Cafferty who forced the gun into his hand, getting Aengus's fingerprints on it. After the shooting, Aengus went berserk, starting the fire to hide the evidence. Determined to trap Cafferty once and for all, Rebus uses his contacts to set up a sting operation, with child molester Andrew McPhail being used as the unwitting bait. Cafferty is caught red-handed attacking McPhail outside the Operation Moneybags surveillance, and is arrested. With Cafferty in jail, the police are able to take a closer look at his operation. A farm in the Borders is raided, where Cafferty used to personally execute his enemies. Deek Torrance is amongst those arrested there. In exchange for leniency, Eddie Ringan agrees to testify against Cafferty. In the final chapter, Rebus accuses Nell Stapleton of being the one who knocked Brian Holmes out. Although he doesn't have any evidence, he does note that she had a motive after the arguments she'd been having with Brian.