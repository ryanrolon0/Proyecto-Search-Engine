Major Michael Hogan orders Sharpe to find out what happened to Claud Hardy, one of his exploring officers, who was sent to locate the gold thought to be in the fictional hamlet of Castejeda. Sharpe sets off with the men of his small company as his sole military support and links up with Major Kearsey, another of Hogan's exploring officers. It becomes clear to Sharpe that Kearsey believes that the gold belongs to the Spanish and should only be returned to them, and that that is the purpose of the mission they are on. However Sharpe has secret orders that the gold must be taken to British lines and begins to doubt Kearsey is aware of them. We meet the local partisan commander El Catolico, who is engaged in a bitter struggle with local French cavalry. Kearsey is captured by the French and Sharpe decides to go into the town and liberate him and ascertain the location of the gold. They succeed though suffer some losses in personnel but succeed in freeing not only Kearsey but also Teresa Moreno and her brother Ramon who were to be tortured by the French. The Spanish guerillas soon enter the town. El Catolico is intensely suspicious of Sharpe being so far behind the French lines and suspects the British desire the gold so they can take it when they leave Portugal. We see Sharpe develop an attraction to Teresa who is betrothed to El Catolico. Her father is his second-in-command. Kearsey appears in awe of El Catolico and the Spanish generally. Sharpe decides to leave him out of future decisions. El Catolico claims there is no gold and that the French took it. Having been escorted from the town by partisans Sharpe and the men double back later that night to undergo a further search of the town. Sharpe is captured by El Catolico but is freed by Patrick Harper who discovered the gold hidden in a manure patch. Sharpe's men surround the Spanish and they take Teresa as a hostage. Kearsey is utterly disapproving of what Sharpe has done but follows the other British soldiers. It seems Hardy was murdered by El Catolico. They head for the fortress of Almeida and are harried by both the partisans and by French troops en route to the siege. Sharpe and Teresa consummate their relationship and fall in love. Sharpe and the men are saved from the French by a unit of German cavalry under Captain Lossow who was sent by Hogan to locate them and take them to Almeida. The officers meet with the commander of the fortress, the English Brigadier Cox. Cox has had no orders from General Wellington to let them pass unheeded and is suspicious of the lack of orders. Kearsey gives no help and it transpires that El Catolico and his men entered the fortress on the same night and lodged a claim on behalf of the Spanish government to take back the gold. Efforts to contact Wellington are in vain as the telegraph is blown up. Cox orders the gold be returned and that Sharpe and his men enlist in the garrison to resist the siege. That night we have a showdown between Sharpe and El Catolico on the roof above Sharpe's bedroom window. Sharpe is victorious, but, realising that his opponent was superior, impaled his leg on the Spaniard's sword so he could render the coup de grace. Demonstrating his ruthlessness, Sharpe ignites an explosion in the magazine of the fortress, which causes a great deal of casualties and considerable damage to the fortress walls. It becomes clear that the fortress will fall much sooner than expected and Sharpe and Lossow are allowed take their men away. Teresa returns to the partisans, taking the name La Aguja (the Needle). It transpires that the gold was needed to develop the enormous defensive Lines of Torres Vedras which held up the French invasion of Marshal André Masséna. Sharpe takes the opportunity of some leave to renew his acquaintance with Josefina, his love interest from Sharpe's Eagle, prompting the reader to speculate on the degree of attraction between himself and Teresa. The lines of Torres Vedras are better described in Sharpe's Escape.