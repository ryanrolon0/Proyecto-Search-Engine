The novel opens with Colonel Philippe Leroux and Captain Paul Delmas fleeing from the King's German Legion toward Sharpe's Light Company. Leroux has just learned the identity of El Mirador, Britain's most important spy in Spain. Leroux kills Delmas and assumes his identity as a ruse to disguise his own identity and then allows himself to be captured by Sharpe's company. Sharpe, on handling Leroux's sword, a Klingenthal sabre, covets it as a finely crafted and superbly balanced fighting sword. As Captain Delmas, Leroux gives his parole to Major Joseph Forrest. Whilst he is being escorted back to Wellington's headquarters, he kills his escort, Ensign MacDonald and escapes on horseback towards Salamanca. Sharpe attempts to shoot him but is blocked from taking the shot when Lieutenant Colonel Windham pursues Leroux on horseback. Leroux successfully defends against Windham's charge and kills Windham. He is then chased by Sharpe and the Light Company but manages to gain sanctuary in one of the three French controlled forts outside Salamanca, after Father Curtis protects him from the Salamancan populace. Sharpe confronts Curtis who explains that he is not Captain Delmas but is in fact Colonel Leroux and that he was protecting the city's population against Leroux's revenge if the city were to be recaptured by the French. Sharpe forms an instant dislike of Curtis who he thinks is sympathetic to the French. In Salamanca Sharpe is introduced to Hélène, La Marquesa de Casares el Grande y Melida Sadaba and to Captain Lord Jack Spears. Wellington's army arrives at Salamanca as part of their manoeuvring with Marshal Marmont's French army and Major Michael Hogan debriefs Sharpe on his encounter with Leroux, discovering that Leroux had a list of payments made by Hogan to his pecuniary spies, many of whom had recently been tortured and killed. Frustrated at Marmont's unwillingness to give battle, Wellington finally sends two Battalions, including the South Essex against two French Battalions in an effort to provoke Marmont to action. The set piece action that follows flows like clockwork for Sharpe and his Light Company and is watched closely by La Marquesa. Following the battle, Sharpe is called to see Wellington who confirms that he has seen Leroux and places him under Hogan's command to ensure Leroux does not escape from the French held forts. Sharpe gains Wellington's permission to use his Light Company for this task as they have also seen Leroux. The Sixth Division attempts to storm the forts by surprise and without the usual preparations. However, the French have been tipped off and defeat the attack. Sharpe has been invited to a party by La Marquesa, which had been planned to celebrate the attack’s success, but decides not to attend, nevertheless Lord Spears later persuades him to come in. As he prepares to leave the party, one of the servants takes him to a private garden for a private meeting with La Marquesa. Sharpe comes to the conclusion that she is El Mirador, which she readily confirms and begs Sharpe to protect her from Leroux of whom she claims she is afraid. They then become lovers. After several days of preparation, the forts are assaulted again and quickly surrender. Sharpe and his men search the forts several times thoroughly but can't locate Leroux. After searching the wounded, Sharpe allows them to be taken to the hospital in Salamanca. After Harper discovers a disemboweled French soldier who doesn't appear to have a full complement of intestines, Sharpe realises that Leroux has disguised himself as a French soldier with a severe stomach wound. Leaving his jacket behind (he had taken it off due to the heat), Sharpe and Harper race back to Salamanca without telling the remainder of the Company that they are going and ascertain that Leroux has probably arrived at the hospital established in the Irish College. Leroux is indeed in the hospital and is waiting to be met by a contact who will provide him with a cloak and a horse to help him escape. Whilst searching the hospital, Harper discovers Leroux and a struggle ensues. Leroux causes Harper to fire his volley gun before he has a chance to bring it to bear and Harper ends up being pushed down a staircase, knocking himself out when his head hits the steps hard. Sharpe, hearing the gunshot, comes running and engages in a sword duel with Leroux until Leroux breaks Sharpe's sabre with his Klingenthal sabre. Before Leroux has time to kill Sharpe, a sentry comes to Sharpe's aid and Leroux flees. Both the sentry with his musket and Sharpe with his rifle miss Leroux. With both men effectively disarmed, Leroux shoots Sharpe with a rifled dueling pistol. Sharpe attempts to evade but is shot in the stomach and loses consciousness as Leroux escapes. The Light Company eventually realise that Sharpe and Harper are missing and Major Hogan is alerted. A search of the hospital finds Harper still unconscious, but Sharpe cannot be found amongst the living nor the British or French dead. When his discarded trousers are found, he is believed to have been mistaken for a dead French soldier and buried in a mass grave already. His death is mourned by the entire South Essex Battalion, Major Hogan and General Wellington, however while it is not yet realised, he has actually been taken to the death ward run by Sergeant Connolley in the dank basement of the Irish College. Sharpe, unrecognised, drifts in and out of consciousness but refuses to die from a wound that is fatal in all but the most exceptional of cases. Hogan hears a story of a mad man digging up the French graves, then when on the streets of Salamanca he finds Harper held in chains by the provosts. He persuades the provosts to let Harper go and finds out that Harper has searched all the recently buried French corpses and not found Sharpe. Hogan and Harper return to the hospital to search again and Harper tells Hogan that Sharpe had not been wearing his jacket and that with his flogging scars he would most likely have been mistaken for a soldier. They realise that there is one place that has not been searched - the soldier's death ward. When they find Sharpe, he is barely alive. He is moved to his own room in the hospital officers’ ward, where he fights to stay alive against infection and fever. While the army moves on, Harper and Isabella (the peasant girl Harper rescued in the Battle of Badajoz} minister to Sharpe's needs. In the meantime, Hogan has assigned Lord Spears to protect El Mirador when he is in public. Harper realises that Sharpe has lost his French cavalry overalls (destroyed by the surgeons), his rifle (stolen) and his sword (broken) - many of the symbols of his sense of identity as a soldier and recognises that he needs to help provide something for Sharpe's spirit to cling onto. He sets about procuring another set of rifleman's trousers, a sword and a rifle. He is unsuccessful in obtaining a rifle, and the sword he obtains, a heavy cavalry sabre, is not quite suited for Sharpe to use as foot infantry. Undeterred, he sets about remaking the sabre to what he knows will be Sharpe's requirements - once finished, it is totally transformed. As he goes to present the sword and trousers to Sharpe, Isabella tells him that not only has Sharpe turned the corner and is in full recovery, but La Marquesa had visited and was taking all three of them to stay in one of her houses by the river. Sharpe is visited by Lord Spears and suggests that Lord Spears is protecting El Mirador. Sharpe's knowledge of this surprises Spears and makes him uncomfortable but he nevertheless confirms Sharpe's hunch. As Sharpe recuperates, Harper, now recovered and confident of Sharpe's progress, returns to the Light Company. A month later, Hogan sends Sharpe a letter telling him that the French will soon be returning to Salamanca and that he must pack and leave. Sharpe prepares to depart the following morning and is surprised in the evening by Father Curtis who is pointing a rifle at him. Father Curtis it turns out is returning Sharpe's own rifle that had been stolen by one of the stonemasons at the College. Curtis tells Sharpe that one of his correspondents in Paris has discovered that Leroux has a multi-lingual sister, Hélène. Curtis believes that this must be La Marquesa and relays a message from Hogan asking Sharpe to give her false information that Wellington's is intending to retreat to the Portuguese border and that he will leave one division as a rearguard to delay the French. The penny drops and Sharpe realises that Curtis is El Mirador, not Hélène. Whilst hoping that she is not a French spy, he agrees to pass on the message, doing so later that evening. Sharpe, still not fully healed, rejoins Wellington's army, riding on a horse that was a gift from La Marquesa. He watches events unfold from the Army headquarters. Marmont, suspecting already that Wellington is racing for the border, has these suspicions confirmed by a message from La Marquesa and he swings his army into pursuit, playing into Wellington's hands and the Battle of Salamanca begins. The French left is destroyed by a British cavalry charge. Marmont and his deputy are injured by case shot and play no further part in the battle instead, General Clausel assumed command. The British Fourth Division (including the South Essex) attack the French centre but are repulsed by a French counterattack using Clausel's reserves. Sharpe seeing the South Essex being pushed back and realising that they need to stay firm in order to channel the French columns into a killing ground for the Sixth Division, can't resist joining the battle. He rides to the Light Company, dismounts, assumes command from Lieutenant Price and orders Harper to shoot the next person who falls back. The Company, back under Sharpe's firm hand, respond and the French column is channelled away from the vulnerable British rear into a the Sixth Divisions killing ground. The column's advance is crushed and the French withdraw under the protection of their still undefeated right, hoping to cross the bridge at Alba de Tormes and thus escape. Wellington, believing that a Spanish garrison held the bridge at Alba de Tormes was slow to follow up, believing the French to be trapped and available for him to defeat in detail at his leisure. Unknown to him though, the Spanish garrison, believing that the British would be defeated had already fled and the French retreat was unopposed. Lord Spears conducts a solo charge against the fleeing French and is shot. Sharpe comes to his aid and they talk. Spears is dying and he wants Sharpe to tell his sister that he died honourably and he tells Sharpe that he wants to die because he has the Black Lion (syphilis) and that he prefers to die whilst he still has his sanity and reputation. He tells Sharpe that he knew that Hélène was a French spy and that he had told Hogan this some time ago. Sharpe realises that he is lying and suspects that he is the traitor in the British headquarters. He threatens to kill Spears by stabbing him in the back with his sabre (as if he were killed whilst running away) and to destroy his reputation with his sister. Spears relents and confesses that he had not escaped Leroux but had been paroled and given money for his gambling habit. He had not sold out Curtis because Leroux already knew but he did give Leroux the book in which Curtis had hidden the details of all the agents in his network. Spears had been hoping that in exchange Leroux would give him a night with his sister, instead, he gave him back his parole and promised to provide his sister with a dowry when he returned to Paris. Spears begs Sharpe to kill him swiftly and to preserve his reputation. Sharpe promises to do so and shoots him so that it looks like he was shot whilst charging the French. He reports the coded book to Hogan who quizzes him on Spears. Sharpe refuses to confirm that Spears was a traitor, but he reads between the lines and understands that while spears was the traitor that Sharpe wants Spears reputation left intact and Hogan is prepared to honour this position. Sharpe, Harper and Hogan pursue the retreating French through the night in an effort to find Leroux. In the morning, they catch up to him, but he is able to outrun them and gains the protection of a French infantry square. The infantry squares subsequently ambush a British cavalry charge against the French cavalry. Against all conventional expectations, the cavalry succeed in breaking the squares, although with heavy casualties. Sharpe wades into the defeated square in which Leroux had been seeking protection, but Leroux shoots at him, missing Sharpe but killing his horse. Dismounted, Sharpe shoots Leroux, wounding him in the leg and causing him to be thrown from his horse. Leroux refuses to fight, preferring to surrender and take his chances at escaping later. Sharpe forces him to fight threatening to kill him if he doesn't. A duel ensues in which Sharpe kills Leroux and then recovers Leroux's Klingenthal sabre and the coded book. Hélène leaves Salamanca, although as a member of the Spanish aristocracy it is not in the British interest to create a scandal by pursuing her as a French spy. She encounters Sharpe as he is leaving and seeing her brother's sword, she asks if Sharpe killed him. Sharpe confirms this and that her brother had killed her horse. Sharpe initially carries both sabres, Harper's present and the Klingenthal, but when he is questioned about this by Hogan, he throws the Klingenthal into the river.