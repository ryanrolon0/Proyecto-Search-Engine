As the book opens, a dwarven demagogue, Grag Hamcrusher, is apparently murdered. Ethnic tensions between Ankh-Morpork's troll and dwarf communities mount in the buildup to the anniversary of the Battle Of Koom Valley an ancient battle where trolls and dwarves seemingly ambushed each other. Lord Vetinari convinces Commander Vimes to interview a vampire applicant to the Ankh-Morpork City Watch. The new recruit, Lance-Constable Salacia "Sally" von Humpeding, along with Sergeant Angua and Captain Carrot, is attached to the investigation surrounding Hamcrusher's death. Meanwhile, Corporal Nobbs and Sergeant Colon begin an investigation into the theft of the fifty-foot painting, The Battle of Koom Valley by the insane artist Methodia Rascal, from a city art gallery. Most of the populace believe the painting holds clues to a treasure hidden in Koom Valley. Nobbs has a new girlfriend, exotic dancer Tawneee; Nobby first caught her eye when slipping an IOU into her garter. Other subplots involve the tension between vampires and werewolves (new recruit Lance-Constable von Humpeding and Sergeant Angua), and the presence of Vetinari's auditor, A.E. Pessimal, in the Watch House. Vimes finds himself pressured by Lord Vetinari to solve the murder quickly, before inter-species war erupts in Ankh-Morpork. Vimes and Sergeant Angua visit the dwarves' under-city mine, where a nervous dwarf named Helmclever draws a mysterious sign in the spilled coffee on his desk. In a fit of his particular brand of omnidirectional anger, Vimes veers off into the mine where he cuts himself, he supposes, on a locked door. Later, he convinces the deep down dwarves to allow Captain Carrot to be the "smelter" who looks for the truth of the murder. When Carrot tries to find that truth, however, he is shown a body that was mutilated after death, and a confusing patch of clues. Angua discovers that a troll really was in the mine at the time of the murder, much to the consternation and fear of the dwarves who claimed a troll did the killing. This troll turns out to be Brick, who is a gutter troll of the lowest sort, addicted to Troll drugs beginning with "S," (such as Slab, Scrape, Slice, Slide etc.) and who becomes the protege of Sergeant Detritus. Angua and Sally soon discover four more bodies in the mine, dwarves clearly murdered by other dwarves. One of these dwarves used his own blood to scrawl yet another mysterious rune on the back of a door in the mine—the same door that Commander Vimes accidentally 'cut' himself on the other side of. The Deep-Downers flee for the mountains, taking the talking cube they found at the bottom of Methodia Rascal's well, and the painting of Koom Valley. As a parting shot, they send a squad of their guards to invade the Vimes/Ramkin family mansion and attempt to murder Lady Sybil Ramkin and Young Sam. The two survive unharmed, thanks to the fighting talents of Vimes and the family butler, Willikins, as well as a dwarf being foolish enough to provoke Sybil's dragons. Vimes, along with family and several members of the Watch, travels to Koom Valley. He believes he is pursuing justice, but an astute troll king named Mr. Shine and a bright young grag named Bashfulsson know that Vimes is carrying the Summoning Dark, the quasi-demonic entity that wreaks vengeance on dwarves who have done evil in the sight of other dwarves. Vimes acquired the Summoning Dark when he touched the cursed door in the city mine, but his own internal watchman proves stronger than it is. Vimes soon discovers the real secret of Koom Valley: the trolls and dwarves did not intend war, but had originally come to Koom Valley to broker peace. Weather conspired against them and after a thick fog caused a "double ambush", a flash flood carried them into the caverns below. The Deep-Downers intended to destroy the evidence of this attempt at peace to continue the war between troll and dwarf and had sought out the cave where the surviving trolls and dwarfs had been washed. Preserved as a form of stalagmite, troll and dwarf had died as friends in the cavern while the ancient troll king and dwarf king played a game of Thud. As the book ends, the tomb of the dead trolls and dwarves is opened to the public, in the hope that the two races will learn to end their centuries of animosity. Also, back in Ankh-Morpork, the equipment that the Deep-Downers had abruptly left behind in their haste, has been confiscated, under the clause of eminent domain by Lord Vetinari, seeing them as useful for his future "Undertaking" project.