Castle in the Air follows the adventures of Abdullah, a handsome young carpet salesman from Zanzib, who daydreams constantly about being a stolen prince. One day a strange traveler comes to his stand to sell a magic carpet. During the night, Abdullah goes to sleep on the carpet but wakes up to find himself in a beautiful garden with a young woman. He tells the woman, Flower-in-the-Night, that he is the stolen prince of his daydreams, believing that he is in fact dreaming. Flower-in-the-Night, who has never seen a man other than her father, first believes that Abdullah is a woman, so Abdullah agrees to return the next night with portraits of many men so that she can make a proper comparison. He does so, and Abdullah and Flower-in-the-Night decide to marry. Abdullah returns the next night, but he arrives just as Flower-in-the-Night is snatched away by a huge flying djinn. Soon after, the Sultan of Zanzib captures Abdullah who then discovers that Flower is actually the Sultan's daughter. Enraged that his daughter is missing, the Sultan blames Abdullah and throws him in jail, threatening to impale him on a 40 foot pole if his daughter is not found. Fortunately, Abdullah is saved by his magic carpet and escapes from Zanzib. Abdullah ends up in the desert and stumbles upon a group of bandits, who have in their possession a particularly cranky genie who grants only one wish a day. In the night, Abdullah steals the genie and flees. After a wish, Abdullah is transported to Ingary and ends up traveling with a bitter Strangian soldier whose country was recently taken in a war with Ingary. While traveling to Kingsbury in search of a wizard, the two stumble upon a cat and her kitten, whom the soldier names Midnight and Whippersnapper, respectively. As they travel, Abdullah wishes for the return of his flying carpet, who brings with it the very Djinn that kidnapped Flower-in-the-Night. It is revealed that the Djinn, Hasruel, is being forced to kidnap princesses from all over the world by his brother, Dalzel. The two proceed on the carpet to Kingsbury, which is where they find Wizard Suliman, who, upon realizing that Midnight is actually a person in cat form, returns her to being a human. As the spell is lifted from the woman, who turns out to be Sophie Pendragon, her baby, Morgan is returned to his normal self as well. However, when they go to collect the baby, he is no longer in the inn, where he was left with the soldier. Abdullah and Sophie then order the carpet to take them to Morgan. The carpet does so, taking them far into the sky, to the castle in the air, which is merely Wizard Howl's castle, having been greatly enlarged. There they meet the stolen princesses and plot with them to escape the castle. Led by Abdullah, they overpower the two Djinn, freeing Hasruel who banishes his brother. Flower-of-the-Night had by then wished the genie free, who turned out to be Sophie's husband, the Wizard Howl.