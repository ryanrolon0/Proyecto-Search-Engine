Henry P. York moves to Henry, Kansas to live with his Uncle Frank, Aunt Dotty, and cousins Penelope, Henrietta, and Anastasia after his parents are abducted while bike trekking in South America. On his first night there, Henry sneaks out of his attic bedroom to go to the bathroom. Instead, he discovers that the door is closed and the light is on. He waits and sees a short man emerge from the bathroom and enter Grandfather's bedroom, a room that has been locked since Grandfather died two years previously. Another night, the plaster from Henry's attic wall starts coming off, revealing two master lock dials to a hundred little locked cupboards. When they are home alone, Henry and Henrietta discover a key in one of the cupboards they have managed to open, which unlocks the door into Grandfather's bedroom. There they find a journal which has a map of the cupboards. One morning Henrietta mysteriously disappears, and Henry discovers a journal entry which tells him how the cupboards work. He crawls through a cupboard in Grandfather's room to find Henrietta. After several strange adventures he finds her in the ballroom of a palace in a ruined city, but they are unable to return until the master locks of the cupboards are set back to their location, and they hide in a dark cupboard. They witness a group of people with wolves called "Witch-Dogs" kill a party, but they escape. Meanwhile, Uncle Frank attempts to find the two of them while Aunt Dotty tells Penelope and Anastasia that Frank came through the cupboards long ago, and it was their great-grandfather who invented the cupboards and made them work. But Frank is too late when a Witch and her cat emerge from the Endor cupboard and stab Frank. The witch is Nimiane, and she has been strengthened by Henry's blood. Aunt Dotty, Penelope, and Anastasia run up to see what's going on, and Aunt Dotty falls into a similar state as Frank. Henry and Henrietta emerge from the cupboard and struggle with the witch, but it is Zeke, a boy who was just dropping by to see if Henry was ready to play baseball, who knocks her out with a swing of his baseball bat. The children push her through the cupboard into an unnamed place, and Dotty and Frank are rushed to the hospital where they are healed. Henrietta discovers a creature that looks like a small flying rhino in one of the cupboards. This creature, called a raggant, was the one banging against his cupboard, causing it to break through the plaster at the beginning of the book. Uncle Frank tells Henry that he came from one of the cupboards as a child, and the raggant has been sent by someone to find him. Meanwhile Nimiane has recovered and is plotting in one of the places beyond the cupboards. The book ends when Henry receives another threatening letter from the post office box.